<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>ç®€è®°â€”â€”å…¨è¿æ¥å±‚ä¸ç¥ç»ç½‘ç»œçš„ä¸¤ç§å®ç°æ–¹å¼ &#8211; ç¿°æ—æœ¨å­çš„ç¬”è®°æœ¬</title>
<meta name="description" content="å‰è¨€ å£°æ˜ æœ¬æ–‡æ‰€è¿°ï¼Œä¸ºã€ŠTensorFlowæ·±åº¦å­¦ä¹ ã€‹ä¸€ä¹¦çš„ä¸ªäººè®°å½•ï¼Œæ–‡ç« ä¸­æœ‰ä¸ªäººç†è§£ã€æ€»ç»“ä»¥åŠå¯¹åŸæ–‡çš„éƒ¨åˆ†æ¬è¿ã€‚è¯·æ‚‰çŸ¥~ æœºå™¨å­¦ä¹ çš„æœ€ç»ˆç›®çš„æ˜¯æ‰¾åˆ°ä¸€ç»„è‰¯å¥½çš„å‚æ•°ğœƒï¼Œä½¿å¾—ğœƒè¡¨ç¤ºçš„æ•°å­¦æ¨¡å‹èƒ½å¤Ÿå¾ˆå¥½åœ°ä»è®­ ç»ƒé›† &hellip;">
<meta name="keywords" content="Tensorflow">
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//cdn.staticfile.org">
<link rel="dns-prefetch" href="//cdn.jsdelivr.net">
<link rel="dns-prefetch" href="//zz.bdstatic.com">
<link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2" type="text/css" media="all">
<style id="md-style-inline-css" type="text/css">.copy-button { cursor: pointer; border: 0; font-size: 12px; text-transform: uppercase; font-weight: 500; padding: 3px 6px 3px 6px; background-color: rgba(255, 255, 255, 0.6); position: absolute; overflow: hidden; top: 5px; right: 5px; border-radius: 3px; } .copy-button:before { content: ""; display: inline-block; width: 16px; height: 16px; margin-right: 3px; background-size: contain; background-image: url("data:image/svg+xml,%3Csvg version=\'1.1\' xmlns=\'http://www.w3.org/2000/svg\' xmlns:xlink=\'http://www.w3.org/1999/xlink\' x=\'0px\' y=\'0px\' width=\'16px\' height=\'16px\' viewBox=\'888 888 16 16\' enable-background=\'new 888 888 16 16\' xml:space=\'preserve\'%3E %3Cpath fill=\'%23333333\' d=\'M903.143,891.429c0.238,0,0.44,0.083,0.607,0.25c0.167,0.167,0.25,0.369,0.25,0.607v10.857 c0,0.238-0.083,0.44-0.25,0.607s-0.369,0.25-0.607,0.25h-8.571c-0.238,0-0.44-0.083-0.607-0.25s-0.25-0.369-0.25-0.607v-2.571 h-4.857c-0.238,0-0.44-0.083-0.607-0.25s-0.25-0.369-0.25-0.607v-6c0-0.238,0.06-0.5,0.179-0.786s0.262-0.512,0.428-0.679 l3.643-3.643c0.167-0.167,0.393-0.309,0.679-0.428s0.547-0.179,0.786-0.179h3.714c0.238,0,0.44,0.083,0.607,0.25 c0.166,0.167,0.25,0.369,0.25,0.607v2.929c0.404-0.238,0.785-0.357,1.143-0.357H903.143z M898.286,893.331l-2.67,2.669h2.67V893.331 z M892.571,889.902l-2.669,2.669h2.669V889.902z M894.321,895.679l2.821-2.822v-3.714h-3.428v3.714c0,0.238-0.083,0.441-0.25,0.607 s-0.369,0.25-0.607,0.25h-3.714v5.714h4.571v-2.286c0-0.238,0.06-0.5,0.179-0.786C894.012,896.071,894.155,895.845,894.321,895.679z M902.857,902.857v-10.286h-3.429v3.714c0,0.238-0.083,0.441-0.25,0.607c-0.167,0.167-0.369,0.25-0.607,0.25h-3.714v5.715H902.857z\' /%3E %3C/svg%3E"); background-repeat: no-repeat; position: relative; top: 3px; } pre { position: relative; } pre:hover .copy-button { background-color: rgba(255, 255, 255, 0.9); }</style>
<link rel="stylesheet" id="fancybox-css" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css?ver=5.7.2" type="text/css" media="all">
<link rel="stylesheet" id="style-css" href="/wp-content/themes/sweet/static/css/sweet.css?ver=5.7.2" type="text/css" media="all">
<link rel="stylesheet" id="prism-css-0-css" href="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/themes/prism.css?ver=1.15.0" type="text/css" media="all">
<link rel="stylesheet" id="prism-css-1-css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/line-numbers/prism-line-numbers.css?ver=1.15.0" type="text/css" media="all">
<link rel="stylesheet" id="emojify-css" href="https://cdn.jsdelivr.net/npm/emojify.js@1.1.0/dist/css/basic/emojify.min.css?ver=1.1.0" type="text/css" media="all">
<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.5.1" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<script type="text/javascript" src="/wp-content/themes/sweet/static/js/sweet.js?ver=5.7.2" id="sweet-js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js?ver=5.7.2" id="fancybox-js"></script>
<link rel="canonical" href="/2020/08/two-realization-methods-of-fully-connected-layer-and-neural-network/">
<link href="/wp-content/uploads/2021/07/1617196601-favicon-32x32-1.png" rel="shortcut icon" type="image/x-icon">
<link href="/wp-content/uploads/2021/07/1617196599-apple-touch-icon.png" rel="apple-touch-icon">
<script type="text/javascript">

</script>
<style type="text/css"></style>
	
	</head>

<body class="post-template-default single single-post postid-83 single-format-standard">


<div class="navbar w-nav">
	<div class="container w-container">
				<a class="logo-block w-inline-block" href="/">
			<img class="logo" src="/wp-content/uploads/2021/07/1617196599-apple-touch-icon.png">
		</a>
				<nav class="nav-menu w-nav-menu">
			<li id="menu-item-97" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97"><a href="https://ytlee.cn/">é¦–é¡µ</a></li>
<li id="menu-item-99" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-99"><a href="/category/note/">ç¬”è®°æœ¬</a></li>
<li id="menu-item-100" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-100"><a href="/category/draft/">è‰ç¨¿æœ¬</a></li>
<li id="menu-item-103" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-103"><a href="/about-me/">å…³äºæˆ‘</a></li>
					</nav>
		<div class="menu-button w-nav-button">
			<div class="w-icon-nav-menu right">
			</div>
		</div>
		<div class="rightNav">
			<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97"><a href="https://ytlee.cn/">é¦–é¡µ</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-99"><a href="/category/note/">ç¬”è®°æœ¬</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-100"><a href="/category/draft/">è‰ç¨¿æœ¬</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-103"><a href="/about-me/">å…³äºæˆ‘</a></li>
		</div>
	</div>
</div>
<div class="bgDiv"></div>

<div class="blog-header">
	<div class="blog-header-overlay"></div>
	<div class="header-image-block" style="background-image: url('/wp-content/uploads/2021/07/1617196066-a4.jpeg');"></div>
</div>
<div class="blog-post-section section">
	<div class="blog-post-container container w-container">
		<div class="white-content-block">
			<div class="blog-post-image-block" style="background-image: url('/wp-content/uploads/2021/07/1617196075-a7.jpeg');">
				<a href="/category/note/" rel="category tag">ç¬”è®°æœ¬</a>				<div class="blog-post-header">
					<div class="blog-header-title-wrapper">
						<div class="blog-post-date">2020-08-23</div>
						<h1 class="blog-post-title">ç®€è®°â€”â€”å…¨è¿æ¥å±‚ä¸ç¥ç»ç½‘ç»œçš„ä¸¤ç§å®ç°æ–¹å¼</h1>
					</div>
				</div>
			</div>
			<div class="align-left white-content-block-content-wrapper">
				<div class="rich-text-block w-richtext">
					<ul>
<li>
<a href="#toc-1">å‰è¨€</a><ul>
<li><a href="#toc-2">å£°æ˜</a></li>
</ul>
</li>
<li><a href="#toc-3">æ„ŸçŸ¥æœºä¸ç¥ç»ç½‘ç»œ</a></li>
<li>
<a href="#toc-4">å…¨è¿æ¥å±‚</a><ul>
<li><a href="#toc-5">å¼ é‡å®ç°å…¨è¿æ¥å±‚</a></li>
<li>
<a href="#toc-6">å±‚æ–¹å¼å®ç°å…¨è¿æ¥å±‚</a><ul>
<li><a href="#toc-7">è·å–å±‚ä¸­æƒé‡çŸ©é˜µå’Œåç½®çŸ©é˜µ</a></li>
<li><a href="#toc-8">è·å–å‚æ•°åˆ—è¡¨</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#toc-9">ç¥ç»ç½‘ç»œ</a><ul>
<li><a href="#toc-10">å¼ é‡å †å å…¨è¿æ¥ç½‘ç»œ</a></li>
<li>
<a href="#toc-11">å±‚æ–¹å¼å †å å…¨è¿æ¥ç½‘ç»œ</a><ul>
<li><a href="#toc-12">Sequentialå®¹å™¨å°è£…å‰å‘ç½‘ç»œ</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<h2>
<a name="toc-1"></a>å‰è¨€</h2>
<h3>
<a name="toc-2"></a>å£°æ˜</h3>
<p><strong>æœ¬æ–‡æ‰€è¿°ï¼Œä¸ºã€ŠTensorFlowæ·±åº¦å­¦ä¹ ã€‹ä¸€ä¹¦çš„ä¸ªäººè®°å½•ï¼Œæ–‡ç« ä¸­æœ‰ä¸ªäººç†è§£ã€æ€»ç»“ä»¥åŠå¯¹åŸæ–‡çš„éƒ¨åˆ†æ¬è¿ã€‚è¯·æ‚‰çŸ¥~</strong></p>
<p>æœºå™¨å­¦ä¹ çš„æœ€ç»ˆç›®çš„æ˜¯æ‰¾åˆ°ä¸€ç»„è‰¯å¥½çš„å‚æ•°ğœƒï¼Œä½¿å¾—ğœƒè¡¨ç¤ºçš„æ•°å­¦æ¨¡å‹èƒ½å¤Ÿå¾ˆå¥½åœ°ä»è®­ ç»ƒé›†ä¸­å­¦åˆ°æ˜ å°„å…³ç³»ğ‘“ğœƒ: ğ’™ â†’ ğ’š, ğ’™, ğ’š âˆˆ ğ”»trainï¼Œä»è€Œåˆ©ç”¨è®­ç»ƒå¥½çš„ğ‘“ğœƒ(ğ’™), ğ’™ âˆˆ ğ”»ğ‘¡ğ‘’ğ‘ ğ‘¡å»é¢„æµ‹æ–° æ ·æœ¬ã€‚ç¥ç»ç½‘ç»œå±äºæœºå™¨å­¦ä¹ çš„ä¸€ä¸ªç ”ç©¶åˆ†æ”¯ï¼Œå®ƒç‰¹æŒ‡åˆ©ç”¨å¤šä¸ªç¥ç»å…ƒå»å‚æ•°åŒ–æ˜ å°„å‡½æ•°ğ‘“ğœƒçš„æ¨¡å‹ã€‚</p>
<h2>
<a name="toc-3"></a>æ„ŸçŸ¥æœºä¸ç¥ç»ç½‘ç»œ</h2>
<p>æ„ŸçŸ¥æœºæ¨¡å‹ç”±äºå…¶æ¿€æ´»å‡½æ•°çš„ä¸å¯å¯¼æ€§è€Œè¢«çº¦æŸï¼Œåªèƒ½æ‰§è¡Œå¾ˆç®€å•çš„ä»»åŠ¡ã€‚ç°åœ¨çš„æ·±åº¦å­¦ä¹ ï¼Œå¤§æ¦‚æ˜¯åœ¨æ„ŸçŸ¥æœºæ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œå°†ä¸å¯å¯¼çš„æ¿€æ´»å‡½æ•°æ›¿æ¢æˆå¹³æ»‘å¯å¯¼çš„å‡½æ•°ï¼Œç„¶åå †å å¤šå±‚ç½‘ç»œæ¥å¢å¼ºç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<h2>
<a name="toc-4"></a>å…¨è¿æ¥å±‚</h2>
<p>æ¯ä¸ªè¾“å‡ºèŠ‚ç‚¹ä¸å…¨éƒ¨çš„ è¾“å…¥èŠ‚ç‚¹ç›¸è¿æ¥ï¼Œè¿™ç§ç½‘ç»œå±‚ç§°ä¸ºå…¨è¿æ¥å±‚(Fully-connected Layer)ï¼Œæˆ–è€…ç¨ å¯†è¿æ¥å±‚(Dense Layer)ï¼Œğ‘¾çŸ©é˜µå«åšå…¨è¿æ¥å±‚çš„æƒå€¼çŸ©é˜µï¼Œğ’ƒå‘é‡å«åšå…¨è¿æ¥å±‚çš„åç½®å‘é‡ã€‚</p>
<h3>
<a name="toc-5"></a>å¼ é‡å®ç°å…¨è¿æ¥å±‚</h3>
<p>è¦å®ç°å…¨è¿æ¥å±‚ï¼Œåªéœ€è¦å®šä¹‰å¥½æƒå€¼å¼ é‡ğ‘¾å’Œåç½®å¼ é‡ğ’ƒï¼Œå¹¶åˆ©ç”¨TensorFlowæä¾›çš„æ‰¹é‡çŸ©é˜µç›¸ä¹˜å‡½æ•° tf.matmul()å³å¯å®Œæˆç½‘ç»œå±‚çš„è®¡ç®—ã€‚</p>
<h5>ç¤ºä¾‹ä»£ç </h5>
<p>åˆ›å»ºè¾“å…¥ğ‘¿ çŸ©é˜µä¸ºğ‘ = 2ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬çš„è¾“å…¥ç‰¹å¾é•¿åº¦ä¸ºğ‘‘in = 784ï¼Œè¾“å‡ºèŠ‚ç‚¹æ•°ä¸ºğ‘‘out = 256ï¼Œæ•… å®šä¹‰æƒå€¼çŸ©é˜µğ‘¾çš„ shape ä¸º[784,256]ï¼Œå¹¶é‡‡ç”¨æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–ğ‘¾ï¼›åç½®å‘é‡ğ’ƒçš„ shape å®šä¹‰ ä¸º[256]ï¼Œåœ¨è®¡ç®—å®Œğ‘¿@ğ‘¾åç›¸åŠ å³å¯ï¼Œæœ€ç»ˆå…¨è¿æ¥å±‚çš„è¾“å‡ºğ‘¶çš„ shape ä¸º[2,256]ï¼Œå³ 2 ä¸ªæ ·æœ¬çš„ç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾é•¿åº¦ä¸º 256ã€‚</p>
<pre><code class="language-python">import tensorflow as tf

x = tf.random.normal([2, 784])
w1 = tf.Variable(tf.random.truncated_normal([784, 256], stddev=0.1))
b1 = tf.Variable(tf.zeros([256]))
o1 = tf.matmul(x, w1) + b1
o1 = tf.nn.relu(o1)
print(o1)</code></pre>
<pre><code class="language-shell">tf.Tensor(
[[0.         0.         0.         6.808429   0.6845355  0.
  0.         0.         1.2036994  0.         ...]], shape=(2, 256), dtype=float32)</code></pre>
<h3>
<a name="toc-6"></a>å±‚æ–¹å¼å®ç°å…¨è¿æ¥å±‚</h3>
<p>ç”±ä¸Šå¼ é‡æ–¹å¼å®ç°çš„å…¨è¿æ¥å±‚æˆ‘ä»¬å®¹æ˜“çŸ¥é“ï¼Œå…¨è¿æ¥å±‚æœ¬è´¨ä¸Šæ˜¯çŸ©é˜µç›¸ä¹˜å’Œç›¸åŠ ã€‚Tensorflowæ˜¯ä¸€ä¸ªæˆç†Ÿçš„æ¡†æ¶ï¼Œä»–å°è£…äº†æ›´å¥½çš„å®ç°æ–¹å¼ï¼Œä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å»å†™è¿™ä¹ˆå¤šè¡Œä»£ç ã€‚</p>
<ul>
<li>å±‚å®ç°æ–¹å¼ï¼šlayers.Dense(units, activation)</li>
<li>éœ€è¦import tensorflow.keras.layers</li>
<li>éœ€è¦æŒ‡å®šè¾“å‡ºèŠ‚ç‚¹æ•°unitsï¼Œå’Œæ¿€æ´»å‡½æ•°ç±»å‹activationå³å¯</li>
<li>åœ¨å¼ é‡å®ç°ä¸­éœ€è¦æŒ‡å®šçš„è¾“å…¥èŠ‚ç‚¹æ•°ï¼Œä¼šåœ¨Denseç±»ä¸­å¯¹è¾“å…¥xè‡ªåŠ¨å¤„ç†</li>
<li>ç”±äºéœ€è¦ç”¨xæ‰èƒ½ç¡®å®šè¾“å…¥èŠ‚ç‚¹æ•°ï¼Œæ‰€ä»¥Denseç±»ä¸­å¹¶ä¸ä¼šç«‹åˆ»åˆ›å»ºæƒé‡çŸ©é˜µå’Œåç½®çŸ©é˜µï¼Œè€Œæ˜¯åœ¨è¿›è¡Œä»¥æ­¤å‰å‘è®¡ç®—åï¼Œæ‰ä¼šåˆ›å»º</li>
</ul>
<h5>ç¤ºä¾‹ä»£ç </h5>
<pre><code class="language-python">import tensorflow as tf
from tensorflow.keras import layers

x = tf.random.normal([2, 28, 28])
x = tf.reshape(x, [-1, 28 * 28])
# w1 = tf.Variable(tf.random.truncated_normal([784, 256], stddev=0.1))
# b1 = tf.Variable(tf.zeros([256]))
# o1 = tf.matmul(x, w1) + b1
# o1 = tf.nn.relu(o1)
fc = layers.Dense(256, activation=tf.nn.relu)
o1 = fc(x)
print(o1)</code></pre>
<pre><code class="language-shell">tf.Tensor(
[[2.25188434e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
  6.86346889e-01 0.00000000e+00 1.57338274e+00 ...]],shape=(2, 256), dtype=float32)</code></pre>
<p>å¦‚ä¸Šä»£ç ï¼Œå®ç°çš„å…¨è¿æ¥å±‚å’Œä¹‹å‰çš„å¼ é‡å®ç°æ˜¯ä¸€æ ·çš„ã€‚</p>
<h4>
<a name="toc-7"></a>è·å–å±‚ä¸­æƒé‡çŸ©é˜µå’Œåç½®çŸ©é˜µ</h4>
<pre><code class="language-python">import tensorflow as tf
from tensorflow.keras import layers

x = tf.random.normal([2, 28, 28])
x = tf.reshape(x, [-1, 28 * 28])
# w1 = tf.Variable(tf.random.truncated_normal([784, 256], stddev=0.1))
# b1 = tf.Variable(tf.zeros([256]))
# o1 = tf.matmul(x, w1) + b1
# o1 = tf.nn.relu(o1)
fc = layers.Dense(256, activation=tf.nn.relu)
o1 = fc(x)
print(fc.kernel)
print(fc.bias)</code></pre>
<pre><code class="language-shell">&lt;tf.Variable &#039;dense/kernel:0&#039; shape=(784, 256) dtype=float32, numpy=
array([[ 0.05471069, -0.0628917 ,  0.03620822, ...,  0.01844664,
        -0.06971153,  0.0447783 ],...], dtype=float32)&gt;
&lt;tf.Variable &#039;dense/bias:0&#039; shape=(256,) dtype=float32, numpy=
array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., ...], dtype=float32)&gt;</code></pre>
<h4>
<a name="toc-8"></a>è·å–å‚æ•°åˆ—è¡¨</h4>
<ul>
<li>
<p>å¾…ä¼˜åŒ–å‚æ•°åˆ—è¡¨</p>
<pre><code class="language-python">fc.trainable_variables</code></pre>
</li>
<li>
<p>æ‰€æœ‰å‚æ•°åˆ—è¡¨</p>
<pre><code class="language-python">fc.variables</code></pre>
</li>
<li>
<p>å¹¶ä¸æ˜¯æ‰€æœ‰å±‚éƒ½åŒ…å«å‚ä¸æ¢¯åº¦ä¼˜åŒ–çš„å¼ é‡ï¼Œå¦‚batch normalizationå±‚</p>
</li>
<li>
<p>Denseå±‚ä¸­æ‰€æœ‰å‚æ•°ç”±éœ€è¦ä¼˜åŒ–</p>
</li>
</ul>
<h2>
<a name="toc-9"></a>ç¥ç»ç½‘ç»œ</h2>
<p><img src="https://cdn.jsdelivr.net/gh/tangger2000/PicHost/img/image-20200904223645683.png" alt="image-20200904223645683"></p>
<ul>
<li>ä¸Šè¿°å›¾ç‰‡æ‰€ç¤ºç½‘ç»œä¸º4å±‚å †å çš„å…¨è¿æ¥ç½‘ç»œ</li>
<li>æ¯å±‚ç½‘ç»œçš„è¾“å…¥èŠ‚ç‚¹æ•°å¿…é¡»ä¸æ•°æ®çš„å®é™…ç‰¹å¾é•¿åº¦æˆ–ä¸Šä¸€å±‚è¾“å‡ºèŠ‚ç‚¹æ•°åŒ¹é…</li>
</ul>
<h3>
<a name="toc-10"></a>å¼ é‡å †å å…¨è¿æ¥ç½‘ç»œ</h3>
<p>ä¸ºå®ç°ä¸Šå›¾å…¨è¿æ¥ç½‘ç»œï¼Œéœ€è¦å®šä¹‰å„å±‚çš„æƒé‡çŸ©é˜µå’Œåç½®å‘é‡ï¼ˆåªå®šä¹‰å‘é‡è€Œä¸æ˜¯çŸ©é˜µæ˜¯å› ä¸ºBroadcastingæŠ€æœ¯ï¼‰</p>
<h5>ç¤ºä¾‹ä»£ç </h5>
<pre><code class="language-python">import tensorflow as tf

# æ¨¡æ‹Ÿè¾“å…¥
x = tf.random.normal([5, 28, 28])
x = tf.reshape(x, [-1, 28 * 28])

# éšè—å±‚ 1 å¼ é‡
w1 = tf.Variable(tf.random.truncated_normal([784, 256], stddev=0.1))
b1 = tf.Variable(tf.zeros([256]))
# éšè—å±‚ 2 å¼ é‡
w2 = tf.Variable(tf.random.truncated_normal([256, 128], stddev=0.1))
b2 = tf.Variable(tf.zeros([128]))
# éšè—å±‚ 3 å¼ é‡
w3 = tf.Variable(tf.random.truncated_normal([128, 64], stddev=0.1))
b3 = tf.Variable(tf.zeros([64]))
# è¾“å‡ºå±‚å¼ é‡
w4 = tf.Variable(tf.random.truncated_normal([64, 10], stddev=0.1))
b4 = tf.Variable(tf.zeros([10]))

with tf.GradientTape() as tape:  # æ¢¯åº¦è®°å½•å™¨
    # éšè—å±‚ 1 å‰å‘è®¡ç®—ï¼Œ[b, 28*28] =&gt; [b, 256]
    h1 = tf.matmul(x, w1) + tf.broadcast_to(b1, [x.shape[0], 256])
    h1 = tf.nn.relu(h1)
    # hiden layer 2,256-&gt;128
    h2 = tf.matmul(h1, w2) + b2
    h2 = tf.nn.relu(h2)
    # hiden layer 3,128-&gt;64
    h3 = tf.matmul(h2, w3) + b3
    h3 = tf.nn.relu(h3)
    # out layer, 64-&gt;10
    h4 = tf.matmul(h3, w4) + b4

    print(h4)</code></pre>
<pre><code class="language-shell">tf.Tensor(
[[ 0.23257127  0.16676497  0.55743366 -0.15181935  0.10486883 -0.73835516
  -0.01012151 -0.17642742 -0.08443141  0.01910783]
 [-0.54381084 -0.7701276   1.1232696  -0.5249761   2.1127691  -1.4001988
   1.1256711  -1.8002102   0.88020146 -1.1632769 ]
 [-0.19568059  0.4636792   0.56755257  0.08363965  0.00799909 -1.4179347
   0.1742461  -0.92967355  0.49695563  0.11684024]
 [ 0.7132307  -0.12016964  0.5661199  -0.837207    0.95532787 -1.0461458
   0.4727786  -1.2410247   0.66738784 -1.4288025 ]
 [-0.89083886  0.3015175   0.6476731  -1.023726    1.1129022   0.13236892
   1.7183071  -0.6784221   0.7361095  -0.9547055 ]], shape=(5, 10), dtype=float32)</code></pre>
<ul>
<li>@è¿ç®—å°±æ˜¯çŸ©é˜µä¹˜è¿ç®—ï¼Œç±»ä¼¼tf.matmulå‡½æ•°</li>
<li>åœ¨ä½¿ç”¨TensorFlowè‡ªåŠ¨æ±‚å¯¼åŠŸèƒ½è®¡ç®—æ¢¯åº¦æ—¶ï¼Œéœ€è¦å°†å‰å‘è®¡ç®—è¿‡ç¨‹æ”¾ç½®åœ¨ tf.GradientTape()ç¯å¢ƒä¸­ï¼Œä»è€Œåˆ©ç”¨GradientTape å¯¹è±¡çš„ gradient()æ–¹æ³•è‡ªåŠ¨æ±‚è§£å‚æ•°çš„æ¢¯åº¦ï¼Œå¹¶åˆ©ç”¨ optimizers å¯¹è±¡æ›´æ–°å‚æ•°ã€‚</li>
</ul>
<h3>
<a name="toc-11"></a>å±‚æ–¹å¼å †å å…¨è¿æ¥ç½‘ç»œ</h3>
<p>ç›´æ¥ä½¿ç”¨layers.Denseç±»æ¥å®ç°ï¼Œæ›´åŠ ç®€æ´é«˜æ•ˆã€‚ä¸å¤šè¯´ï¼Œä¸Šä»£ç ï¼</p>
<h5>ç¤ºä¾‹ä»£ç </h5>
<pre><code class="language-python">import tensorflow as tf
from tensorflow.keras import layers

x = tf.random.normal([5, 28 * 28])

fc1 = layers.Dense(256, activation=tf.nn.relu)
fc2 = layers.Dense(128, activation=tf.nn.relu)
fc3 = layers.Dense(64, activation=tf.nn.relu)
fc4 = layers.Dense(10, activation=None)

h1 = fc1(x)
h2 = fc2(h1)
h3 = fc3(h2)
h4 = fc4(h3)
print(h4)</code></pre>
<p>å’Œå¼ é‡å †å æ¯”èµ·æ¥ï¼Œåˆ©ç”¨å±‚å®ç°çš„ç½‘ç»œæ›´åŠ çš„ç®€æ´ï¼Œä½†å¯¹äºå‰å‘ç¥ç»ç½‘ç»œæˆ‘ä»¬è¿˜å¯ä»¥æ›´ç®€å•ä¸€äº›ã€‚</p>
<h4>
<a name="toc-12"></a>Sequentialå®¹å™¨å°è£…å‰å‘ç½‘ç»œ</h4>
<pre><code class="language-python">import tensorflow as tf
from tensorflow.keras import layers,Sequential

x = tf.random.normal([5, 28 * 28])

model = Sequential([
    layers.Dense(256, activation=tf.nn.relu),
    layers.Dense(128, activation=tf.nn.relu),
    layers.Dense(64, activation=tf.nn.relu),
    layers.Dense(10, activation=None)
    ])
out = model(x)
print(out)</code></pre>
									</div>
				<div class="blog-author-block w-clearfix">
					<div class="blog-author-image" style="background-image: url('https://cdn.v2ex.com/gravatar/90418ca09c90fa30b5fceaf7bae4ac31?s=200&d=mm&r=g');"></div>
					<div class="blog-author-title name">tangger</div>
					<div class="blog-author-title">
						æˆ‘è¿˜æ²¡æœ‰å­¦ä¼šå†™ä¸ªäººè¯´æ˜ï¼					</div>
					<a href="/author/tangger/" style="font-size: 14px">æŸ¥çœ‹â€œtanggerâ€çš„æ‰€æœ‰æ–‡ç«  â†’</a>
				</div>
			</div>
		</div>
		
<div id="comments" class="comments-area">

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2020/08/two-realization-methods-of-fully-connected-layer-and-neural-network/#respond" style="display:none;">Cancel reply</a></small>
</h3>
<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p>
<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p>
<p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="83" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p>
</form>	</div>
<!-- #respond -->
	
</div>	</div>
</div>


<div class="light-tint section">
	<div class="container w-container">
		<div class="section-title-wrapper">
			<h2 class="section-title">ç›¸å…³æ¨è</h2>
		</div>
		<div class="blog-list-wrapper w-dyn-list">
			<div class="blog-posts-list w-clearfix w-dyn-items w-row">
				
				
				<div class="blog-post-item w-col w-col-4 w-dyn-item">
					<a class="blog-post-image-link-block small w-inline-block" title="è®°å½•â€”â€”Docker+Tensorflow2åˆä½“éªŒ" href="/2020/10/try-to-learn-tensorflow2-on-docker/" style="background-image: url('/wp-content/uploads/2021/07/1617196075-a7.jpeg');">
						<div class="blog-author-wrapper small w-clearfix">
														<div class="blog-date small">2020-10-01</div>
						</div>
					</a>
					<a class="blog-title-link" title="è®°å½•â€”â€”Docker+Tensorflow2åˆä½“éªŒ" href="/2020/10/try-to-learn-tensorflow2-on-docker/">è®°å½•â€”â€”Docker+Tensorflow2åˆä½“éªŒ</a>
				</div>

				
				<div class="blog-post-item w-col w-col-4 w-dyn-item">
					<a class="blog-post-image-link-block small w-inline-block" title="ç®€è®°â€”â€”Tensorflow2è¿›é˜¶çŸ¥è¯†ä¸‹" href="/2020/08/study-notes-on-tensorflow-part2/" style="background-image: url('/wp-content/uploads/2021/07/1586231926-thumb-40.jpg.pagespeed.ce_.0mYnnbmrIH.jpg');">
						<div class="blog-author-wrapper small w-clearfix">
														<div class="blog-date small">2020-08-21</div>
						</div>
					</a>
					<a class="blog-title-link" title="ç®€è®°â€”â€”Tensorflow2è¿›é˜¶çŸ¥è¯†ä¸‹" href="/2020/08/study-notes-on-tensorflow-part2/">ç®€è®°â€”â€”Tensorflow2è¿›é˜¶çŸ¥è¯†ä¸‹</a>
				</div>

				
				<div class="blog-post-item w-col w-col-4 w-dyn-item">
					<a class="blog-post-image-link-block small w-inline-block" title="ç®€è®°â€”â€”Tensorflowè¿›é˜¶çŸ¥è¯†ä¸Š" href="/2020/08/study-notes-on-tensorflow-part1/" style="background-image: url('/wp-content/uploads/2021/07/1617199378-c8.jpeg');">
						<div class="blog-author-wrapper small w-clearfix">
														<div class="blog-date small">2020-08-19</div>
						</div>
					</a>
					<a class="blog-title-link" title="ç®€è®°â€”â€”Tensorflowè¿›é˜¶çŸ¥è¯†ä¸Š" href="/2020/08/study-notes-on-tensorflow-part1/">ç®€è®°â€”â€”Tensorflowè¿›é˜¶çŸ¥è¯†ä¸Š</a>
				</div>

								
			</div>
		</div>
	</div>
</div>
<div class="footer">
	<div class="container w-container">
		<div class="footer-text">
			Copyright2021. All Rights Reserved.&nbsp;			
						
			
				&nbsp;<a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/">æ¸ICPå¤‡19011860å·-2</a>

					</div>
		
		<div class="_2 footer-text">
			Powered by
			<a href="http://www.xintheme.com/" target="_blank">XinTheme</a> + 
			<a href="https://blog.wpjam.com/" target="_blank">WordPress æœé…±</a>
		</div>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/components/prism-core.min.js?ver=1.15.0" id="prism-js-0-js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/prism.min.js?ver=1.15.0" id="prism-js-1-js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/plugins/line-numbers/prism-line-numbers.min.js?ver=1.15.0" id="prism-js-2-js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/plugins/autoloader/prism-autoloader.min.js?ver=1.15.0" id="prism-js-3-js"></script>
<script type="text/javascript" src="/wp-includes/js/clipboard.min.js?ver=5.7.2" id="clipboard-js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emojify.js@1.1.0/dist/js/emojify.min.js?ver=1.1.0" id="emojify-js"></script>
<script type="text/javascript" src="https://zz.bdstatic.com/linksubmit/push.js?ver=5.7.2" id="baidu_zz_push-js"></script>
 <script id="auto_loader_config_scripts"> Prism.plugins.autoloader.languages_path = "https://cdn.jsdelivr.net/npm/prismjs@1.15.0/components/"; </script>  <script id="module-prism-line-number"> (function($) { $(function() { $("code").each(function() { var parent_div = $(this).parent("pre"); var pre_css = $(this).attr("class"); if (typeof pre_css !== "undefined" && -1 !== pre_css.indexOf("language-")) { parent_div.addClass("line-numbers"); } }); }); })(jQuery); </script>  <script id="module-clipboard"> (function($) { $(function() { var pre = document.getElementsByTagName("pre"); var pasteContent = document.getElementById("paste-content"); var hasLanguage = false; for (var i = 0; i < pre.length; i++) { var codeClass = pre[i].children[0].className; var isLanguage = codeClass.indexOf("language-"); var excludedCodeClassNames = [ "language-katex", "language-seq", "language-sequence", "language-flow", "language-flowchart", "language-mermaid", ]; var isExcluded = excludedCodeClassNames.indexOf(codeClass); if (isExcluded !== -1) { isLanguage = -1; } if (isLanguage !== -1) { var button = document.createElement("button"); button.className = "copy-button"; button.textContent = "Copy"; pre[i].appendChild(button); hasLanguage = true; } }; if (hasLanguage) { var copyCode = new ClipboardJS(".copy-button", { target: function(trigger) { return trigger.previousElementSibling; } }); copyCode.on("success", function(event) { event.clearSelection(); event.trigger.textContent = "Copied"; window.setTimeout(function() { event.trigger.textContent = "Copy"; }, 2000); }); } }); })(jQuery); </script> 
			<script id="module-emojify">
				(function($) {
					$(function() {
						if (typeof emojify !== "undefined") {
							emojify.setConfig({
								img_dir: "https://cdn.jsdelivr.net/npm/emojify.js@1.1.0/dist/images/basic",
								blacklist: {
									"classes": ["no-emojify"],
									"elements": ["script", "textarea", "pre", "code"]
								}
							});
							emojify.run();
						} else {
							console.log("[wp-githuber-md] emogify is undefined.");
						}
					});
				})(jQuery);
			</script>
			</div>
</div>
<div class="gotop-wrapper">
	<a href="javascript:;" class="fixed-gotop gotop"></a>
</div>
</body>
</html>